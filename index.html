<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Hack Simülatörü</title>
    <style>
        /* Temel stiller */
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #031321;
            font-family: 'Courier New', monospace;
            color: #00d9ff;
            background-image: 
                linear-gradient(rgba(0, 30, 50, 0.7) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 30, 50, 0.7) 1px, transparent 1px);
            background-size: 30px 30px;
        }
        
        #gameContainer {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-around;
            overflow: hidden;
        }
        
        /* CPU ve ana sistem bileşenleri */
        #cpu {
            width: 160px;
            height: 120px;
            border: 3px solid #00d9ff;
            border-radius: 10px;
            margin-top: 30px;
            position: relative;
        }
        
        #cpuBase {
            width: 80px;
            height: 20px;
            background-color: #00d9ff;
            margin: 0 auto;
            position: relative;
            top: 120px;
        }
        
        /* Antivirüs Kalkanı */
        #shield {
            width: 80px;
            height: 80px;
            position: relative;
            margin: 15px auto;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #shieldIcon {
            width: 60px;
            height: 60px;
            border: 3px solid #00d9ff;
            border-radius: 50% 50% 50% 50% / 12% 12% 88% 88%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #shieldIcon:after {
            content: "✓";
            font-size: 30px;
            color: #00d9ff;
        }
        
        /* Zaman sayacı */
        #timer {
            font-size: 36px;
            font-weight: bold;
            color: #ff9100;
            margin: 30px 0 20px 0; /* Daha fazla boşluk için üst marjini arttırdım */
            text-shadow: 0 0 10px rgba(255, 145, 0, 0.5);
            text-align: center; /* Ortaya hizala */
            position: relative; /* Pozisyonu netleştir */
        }
        
        /* Şifre monitörleri ve kod modülleri */
        .monitorRow {
            position: relative;
            display: flex;
            justify-content: center;
            width: 90%;
            max-width: 800px;
            margin: 20px 0;
            z-index: 2;
        }
        
        .monitor {
            width: 50px;
            height: 50px;
            border: 3px solid #ff00aa;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            margin: 0 5px;
            position: relative;
        }
        
        .password-monitor {
            color: #00d9ff;
            border-color: #00d9ff;
        }
        
        .code-monitor {
            color: #00d9ff; /* Fuşya yerine cyan renk */
        }
        
        /* Kalkanlar (ara katman) */
        .shieldRow {
            display: none; /* Bu satırı eskiden görünen kalkanları gizlemek için ekliyoruz */
        }
        
        .miniShield {
            width: 30px;
            height: 30px;
            border: 2px solid #00d9ff;
            border-radius: 50% 50% 50% 50% / 12% 12% 88% 88%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 0, 0, 0.8);
            position: absolute; /* Mutlak konumlandırma */
            transform: translate(-50%, -50%); /* Merkeze hizalama */
            z-index: 5; /* Kabloların üzerinde görünmesi için */
        }
        
        .miniShield:after {
            content: "✓";
            font-size: 16px;
            color: #00d9ff;
        }
        
        /* Active sınıfı kaldırıldı çünkü artık sadece görsel amaçlı */
        
        /* USB ve kontrol butonları */
        #usbContainer {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 400px;
            margin: 25px auto 0;
            position: relative;
        }
        
        .usb-row {
            display: flex;
            width: 100%;
            justify-content: center;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .side-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 15px;
        }
        
        #usb {
            width: 70px;
            height: 100px;
            border: 3px solid #ff00aa;
            border-radius: 5px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        #usb.active {
            box-shadow: 0 0 20px #ff00aa, 0 0 40px #ff00aa;
            transform: scale(1.05);
        }
        
        #usbIcon {
            font-size: 40px;
            color: #00d9ff;
        }
        
        /* Sadece normal boyutlar için */
        @media (min-width: 768px) {
            #usbIcon {
                font-size: 40px;
            }
        }
        
        .controls {
            display: flex;
            justify-content: center;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn {
            background-color: transparent;
            color: #00d9ff;
            border: 2px solid;
            padding: 10px 20px;
            margin: 0 10px;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn:hover {
            background-color: rgba(0, 217, 255, 0.1);
        }
        
        #connectBtn {
            border-color: #00d9ff;
            min-width: 140px;
            background-color: rgba(0, 0, 0, 0.6);
            box-shadow: 0 0 5px rgba(0, 217, 255, 0.5);
            color: #00d9ff;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 20px;
            padding: 12px 25px;
        }
        
        #connectBtn:hover {
            background-color: rgba(0, 217, 255, 0.2);
            box-shadow: 0 0 10px rgba(0, 217, 255, 0.8);
        }
        
        .arrowBtn {
            border-color: #ff00aa;
            color: #ff00aa;
            width: 50px;
            height: 50px;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0;
            background-color: rgba(0, 0, 0, 0.6);
            box-shadow: 0 0 5px rgba(255, 0, 170, 0.5);
        }
        
        .arrowBtn:hover {
            background-color: rgba(255, 0, 170, 0.2);
            box-shadow: 0 0 10px rgba(255, 0, 170, 0.8);
        }
        
        /* Oyun ekranları */
        .gameScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: rgba(3, 19, 33, 0.9);
            z-index: 100;
            color: #00d9ff;
        }
        
        #startScreen {
            display: flex;
        }
        
        #gameOverScreen, #winScreen {
            display: none;
        }
        
        .screenTitle {
            font-size: 48px;
            margin-bottom: 30px;
            color: #ff00aa;
            text-shadow: 0 0 10px rgba(255, 0, 170, 0.7);
            text-align: center;
            position: relative;
            top: 0;
            transform: translateY(0);
        }
        
        /* Başlangıç ekranı için özel stil */
        #startScreen .screenTitle {
            position: relative;
            top: 0;
            transform: translateY(0);
            margin-top: -100px; /* Başlık yukarı kaydırılıyor */
        }
        
        .screenText {
            font-size: 24px;
            margin-bottom: 20px;
            text-align: center;
            max-width: 80%;
            line-height: 1.4;
        }
        
        /* Kazanma ekranı içeriğini ortalamak için ek stil */
        #winScreen {
            display: none;
            position: fixed; /* Absolute yerine fixed kullanımı */
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #winScreen .screenTitle,
        #winScreen .screenText,
        #winScreen .bigBtn {
            margin-left: auto;
            margin-right: auto;
            text-align: center;
            position: relative; /* Position relative for better alignment */
        }
        
        /* Özel "Kalan süre" gösterimi için stil */
        #remainingTime {
            font-weight: bold;
            color: #ff9100; /* Turuncu renk */
            text-shadow: 0 0 8px rgba(255, 145, 0, 0.6);
        }
        
        .bigBtn {
            background-color: transparent;
            border: 3px solid #00d9ff;
            color: #00d9ff;
            padding: 15px 30px;
            font-size: 24px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px; /* Butonun üstünde ek boşluk */
        }
        
        .bigBtn:hover {
            background-color: rgba(0, 217, 255, 0.2);
            text-shadow: 0 0 10px #00d9ff;
            box-shadow: 0 0 20px rgba(0, 217, 255, 0.5);
        }
        
        /* Seçili kutu için animasyon */
        @keyframes selected-pulse {
            0% { box-shadow: 0 0 15px #00d9ff, 0 0 25px #00d9ff; }
            50% { box-shadow: 0 0 20px #ffffff, 0 0 30px #00d9ff; }
            100% { box-shadow: 0 0 15px #00d9ff, 0 0 25px #00d9ff; }
        }
        
        /* Aktif monitör vurgusu */
        .monitor.selected {
            box-shadow: 0 0 15px #00d9ff, 0 0 25px #00d9ff;
            border-color: #ffffff;
            border-width: 3px;
            background-color: rgba(0, 217, 255, 0.3);
            z-index: 20; /* Diğer monitörlerin üzerinde görünmesi için z-index artırıldı */
            position: relative;
            transform: scale(1.1); /* Biraz daha büyük göster */
            outline: 2px solid white; /* Beyaz bir dış çizgi ekle */
            outline-offset: 2px; /* Dış çizgiyi biraz dışarı çıkart */
            animation: selected-pulse 1.5s infinite; /* Seçili kutu animasyonu */
        }
        
        /* Monitör üzerindeki işaretçi - Kaldırıldı */
        .monitor.selected::before {
            display: none;
        }
        
        @keyframes pointer-bounce {
            0% {
                transform: translateX(-50%) translateY(0);
            }
            100% {
                transform: translateX(-50%) translateY(-5px);
            }
        }
        
        /* Kilitlenmiş monitör */
        .monitor.locked {
            border-color: #ff00aa; /* Kilit durumunda fuşya sınır */
        }
        
        /* Doğru değer ve kilitli için geçici yeşil stil */
        .monitor.locked.correct {
            color: #00ff00; /* Saf yeşil */
            text-shadow: 0 0 10px #00ff00;
            border-color: #00ff00;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.7);
            z-index: 15; /* Seçilmemiş kutulardan daha yüksek ama seçili kutunun altında */
        }
        
        /* Slot makinası durduktan sonra doğru değer geldiğinde kutucuğun stilini değiştir */
        .monitor.correct-value {
            color: #00d9ff; /* Su yeşili (cyan) rengi */
            text-shadow: 0 0 10px #00d9ff;
            border-color: #00d9ff;
        }
        
        /* Hem seçili hem de doğru değer içeren monitor */
        .monitor.selected.correct-value {
            color: #00d9ff;
            box-shadow: 0 0 15px #00d9ff, 0 0 25px #00d9ff;
            border-color: #ffffff;
            text-shadow: 0 0 5px #00d9ff;
            background-color: rgba(0, 217, 255, 0.3);
            outline: 2px solid white; /* Beyaz bir dış çizgi ekle */
            outline-offset: 2px; /* Dış çizgiyi biraz dışarı çıkart */
            animation: selected-pulse 1.5s infinite; /* Seçili kutu animasyonu */
        }
        
        /* Kilitleme animasyonu */
        .monitor.just-locked {
            animation: locked-pulse 0.5s ease;
        }
        
        @keyframes locked-pulse {
            0% { transform: scale(1); border-color: #ff00aa; }
            50% { transform: scale(1.2); border-color: #00ff00; }
            100% { transform: scale(1); border-color: #00ff00; }
        }
        
        /* Animasyonlar */
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(0, 217, 255, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(0, 217, 255, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 217, 255, 0); }
        }
        
        .pulse {
            animation: pulse 1.5s infinite;
        }
        
        /* Mobil uyumluluk için */
        @media (max-width: 767px) {
            body {
                font-size: 16px;
                padding-bottom: 350px; /* Daha büyük butonlar için ek boşluk */
            }
            
            #gameContainer {
                justify-content: flex-start;
                padding: 20px 0 350px 0; /* Alt kısma ek boşluk */
                min-height: 100vh;
                height: auto;
            }
            
            .monitor {
                width: 38px;
                height: 38px;
                font-size: 30px !important; /* Font boyutunu önemli ölçüde arttırıyoruz ve !important ekliyoruz */
                margin: 0 2px; /* Boşluğu biraz daha azalttık */
                border-width: 2px;
                display: flex;
                align-items: center;
                justify-content: center;
                text-shadow: 0 0 4px currentColor; /* Metin gölgesini artırdık */
                font-weight: bold; /* Font kalınlığını artırdık */
                overflow: hidden; /* Taşmaları engellemek için */
            }
            
            /* Monitör içindeki yazıların boyutuna özel kural */
            .monitor span, .monitor div {
                font-size: 30px !important;
            }
            
            /* Doğrudan text içeriğine etki eden style */
            .code-monitor, .password-monitor {
                font-size: 30px !important;
            }
            
            .miniShield {
                width: 30px;
                height: 30px;
                border-width: 2px;
                z-index: 30;
                box-shadow: 0 0 10px rgba(0, 217, 255, 0.7);
            }
            
            .miniShield:after {
                font-size: 16px;
            }
            
            .screenTitle {
                font-size: 28px;
            }
            
            .screenText {
                font-size: 16px;
            }
            
            .bigBtn {
                padding: 12px 25px;
                font-size: 18px;
            }
            
            #timer {
                font-size: 32px;
                margin: 20px 0;
            }
            
            #usb {
                width: 160px; /* İki katına çıkardık */
                height: 200px; /* İki katına çıkardık */
                margin-bottom: 5px;
            }
            
            #usbIcon {
                font-size: 80px; /* İkon boyutunu da iki katına çıkardık */
            }
            
            .side-controls {
                margin: 0 20px; /* Daha büyük USB için yan boşlukları da arttırdık */
            }
            
            .arrowBtn {
                width: 130px; /* 65px'in 2 katı */
                height: 130px; /* 65px'in 2 katı */
                font-size: 60px; /* 30px'in 2 katı */
                border-width: 3px;
                box-shadow: 0 0 15px rgba(255, 0, 170, 0.7);
            }
            
            #usbContainer {
                margin: 0;
                position: fixed;
                bottom: 80px; /* Zeminden yukarı çektik */
                left: 0;
                right: 0;
                background-color: rgba(3, 19, 33, 0.95);
                padding: 15px 0;
                z-index: 50;
                border-top: 2px solid rgba(0, 217, 255, 0.3);
                box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.5);
            }
            
            .controls {
                margin-top: 5px;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 16px;
                margin: 0 5px;
            }
            
            #connectBtn {
                min-width: 360px; /* 180px'in 2 katı */
                height: 80px; /* Yüksekliği de 2 kat arttırdık */
                margin-top: 5px;
                padding: 0;
                font-size: 40px; /* 20px'in 2 katı */
                border-width: 3px;
                box-shadow: 0 0 15px rgba(0, 217, 255, 0.7);
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .wire {
                width: 5px;
                box-shadow: 0 0 10px rgba(255, 0, 170, 0.7);
                z-index: 25;
            }
            
            /* Monitörler arasındaki mesafe */
            .monitorRow {
                margin: 20px 0;
                max-width: 95%; /* 90%'dan 95%'e çıkardık */
                width: 95%; /* Genişliği belirttik */
            }
            
            /* Monitör satırları arasında çok daha fazla mesafe */
            #passwordRow {
                margin-bottom: 60px; /* 30px'in 2 katı */
                margin-top: 20px;
            }
            
            #codeRow {
                margin-top: 60px; /* 30px'in 2 katı */
                margin-bottom: 10px;
                position: static;
                bottom: auto;
            }
            
            /* Seçili kutu mobilde daha belirgin */
            .monitor.selected {
                box-shadow: 0 0 15px #00d9ff, 0 0 25px #00d9ff;
                border-width: 3px;
                transform: scale(1.15);
                outline: 2px solid white; /* Beyaz bir dış çizgi ekle */
                outline-offset: 2px; /* Dış çizgiyi biraz dışarı çıkart */
            }
            
            /* Doğru değere sahip kilitli kutular daha belirgin */
            .monitor.locked.correct {
                box-shadow: 0 0 12px #00ff00;
                border-width: 3px;
                z-index: 15;
            }
            
            /* Seçili kilitli kutular - mobil ek stil */
            .monitor.selected.locked.correct {
                border-color: #ffffff;
                box-shadow: 0 0 15px #00d9ff, 0 0 25px #00d9ff;
                z-index: 20;
                transform: scale(1.15);
                background-color: rgba(0, 217, 255, 0.3);
                outline: 2px solid white; /* Beyaz bir dış çizgi ekle */
                outline-offset: 2px; /* Dış çizgiyi biraz dışarı çıkart */
            }
        }
        
        /* Daha küçük ekranlar için (telefonlar) */
        @media (max-width: 480px) {
            body {
                padding-bottom: 300px;
            }
            
            #gameContainer {
                padding: 20px 0 300px 0;
            }
            
            .monitor {
                width: 32px;
                height: 32px;
                font-size: 26px !important; /* Font boyutunu önemli ölçüde arttırıyoruz ve !important ekliyoruz */
                margin: 0 2px; /* Margin'i biraz daha azalttık */
                border-width: 2px;
                text-shadow: 0 0 5px currentColor; /* Metin gölgesini artırdık */
                font-weight: bold; /* Font kalınlığını koruyoruz */
                line-height: 1; /* Line-height'i azalttık */
                padding: 0; /* Padding'i sıfırladık */
            }
            
            /* Monitör içindeki yazıların boyutuna özel kural */
            .monitor span, .monitor div {
                font-size: 26px !important;
            }
            
            .password-monitor {
                color: #00ffff; /* Daha parlak cyan renk */
                text-shadow: 0 0 5px #00ffff; /* Belirgin gölge */
            }
            
            .code-monitor {
                color: #00ffff; /* Daha parlak cyan renk */
                text-shadow: 0 0 5px #00ffff; /* Belirgin gölge */
            }
            
            .miniShield {
                width: 28px;
                height: 28px;
                border-width: 2px;
            }
            
            .miniShield:after {
                font-size: 15px;
            }
            
            .screenTitle {
                font-size: 24px;
            }
            
            .screenText {
                font-size: 14px;
            }
            
            #timer {
                font-size: 28px;
                margin: 15px 0;
            }
            
            .monitorRow {
                margin: 15px 0;
                width: 95%; /* 95% yapıldı */
                max-width: 95%; /* 95% yapıldı */
            }
            
            /* Monitör satırları arasında çok daha fazla mesafe */
            #passwordRow {
                margin-bottom: 50px; /* 25px'in 2 katı */
                margin-top: 15px;
            }
            
            #codeRow {
                margin-top: 50px; /* 25px'in 2 katı */
                margin-bottom: 10px;
                position: static;
                bottom: auto;
            }
            
            .btn {
                padding: 8px 15px;
                font-size: 14px;
                margin: 0 3px;
            }
            
            #connectBtn {
                min-width: 300px; /* 150px'in 2 katı */
                height: 70px;
                margin-top: 5px;
                font-size: 36px; /* 18px'in 2 katı */
                border-width: 3px;
            }
            
            #usb {
                width: 120px; /* Küçük ekranlarda biraz daha küçültüyoruz ama yine de büyük */
                height: 150px;
            }
            
            #usbIcon {
                font-size: 60px;
            }
            
            .side-controls {
                margin: 0 15px;
            }
            
            .arrowBtn {
                width: 110px; /* 55px'in 2 katı */
                height: 110px; /* 55px'in 2 katı */
                font-size: 52px; /* 26px'in 2 katı */
                border-width: 3px;
            }
            
            .wire {
                width: 3px;
            }
            
            #usbContainer {
                padding: 10px 0;
                bottom: 60px; /* Küçük ekranlarda biraz daha az yukarı çektik */
            }
        }
        
        /* Aşama geçiş animasyonu */
        .transition-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 200;
            opacity: 1;
            transition: opacity 1s ease;
        }
        
        .transition-text {
            color: #00ff00;
            font-size: 36px;
            font-weight: bold;
            text-align: center;
            text-shadow: 0 0 20px #00ff00;
            animation: text-scale 2s ease infinite;
        }
        
        @keyframes text-scale {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* Kablo çizgileri */
        .wires-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none; /* Tıklamaları engellememek için */
        }
        
        .wire {
            position: absolute;
            height: 100px; /* Başlangıç yüksekliği, dinamik olarak ayarlanacak */
            width: 5px; /* Kablo kalınlığı arttırıldı */
            background-color: #ff00aa; /* Fuşya renk */
            transform-origin: top center;
            box-shadow: 0 0 10px rgba(255, 0, 170, 0.7); /* Daha parlak glow efekti */
            z-index: 25;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }
        
        /* Aktif kablolar */
        .wire.active {
            background-color: #ff00aa;
            box-shadow: 0 0 15px #ff00aa; /* Daha yoğun glow */
            animation: wire-pulse 1.5s infinite;
            width: 6px; /* Aktif kablo daha kalın */
        }
        
        /* Başarıyla kilitlenen monitörler için kablo rengi */
        .wire.success {
            background-color: #00ff00;
            box-shadow: 0 0 12px #00ff00;
            animation: wire-success 1s forwards;
        }
        
        /* Başarılı kabloların animasyonu */
        @keyframes wire-success {
            0% { 
                background-color: #ff00aa; 
                box-shadow: 0 0 10px rgba(255, 0, 170, 0.7);
            }
            50% { 
                background-color: #ffffff; 
                box-shadow: 0 0 20px rgba(255, 255, 255, 0.9);
            }
            100% { 
                background-color: #00ff00; 
                box-shadow: 0 0 12px #00ff00;
            }
        }
        
        /* Matriks yeşili ikon için stil */
        .miniShield.matrix-green {
            border-color: #00ff00; /* Matriks yeşili sınır */
            box-shadow: 0 0 8px #00ff00; /* Matriks yeşili glow efekti */
        }
        
        .miniShield.matrix-green:after {
            color: #00ff00; /* Matriks yeşili içerik */
            text-shadow: 0 0 8px #00ff00;
        }
        
        @keyframes wire-pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }
        
        /* Dokunmatik cihazlar için daha büyük tıklama alanları */
        @media (pointer: coarse) {
            .btn {
                min-height: 44px; /* Dokunmatik için önerilen minimum dokunma alanı */
            }
            
            #usb {
                min-height: 60px;
            }
            
            .monitor {
                touch-action: manipulation; /* Çift dokunma zoom'u engelle */
            }
        }
        
        /* Üst monitöre transfer animasyonu */
        @keyframes transfer-glow {
            0% { 
                box-shadow: 0 0 5px rgba(0, 217, 255, 0.3);
                border-color: #00d9ff;
                background-color: rgba(0, 217, 255, 0.1);
            }
            50% { 
                box-shadow: 0 0 20px rgba(0, 217, 255, 0.8);
                border-color: #ffffff;
                background-color: rgba(0, 217, 255, 0.3);
            }
            100% { 
                box-shadow: 0 0 8px rgba(0, 217, 255, 0.5);
                border-color: #00d9ff;
                background-color: rgba(0, 217, 255, 0.1);
            }
        }
        
        /* Alt monitöre geri dönüş animasyonu */
        @keyframes return-to-fuschia {
            0% { 
                box-shadow: 0 0 8px #00ff00;
                border-color: #00ff00;
                background-color: rgba(0, 255, 0, 0.1);
            }
            50% { 
                box-shadow: 0 0 15px #ff00aa;
                border-color: #ffffff;
                background-color: rgba(255, 0, 170, 0.3);
            }
            100% { 
                box-shadow: 0 0 8px #ff00aa;
                border-color: #ff00aa;
                background-color: rgba(255, 0, 170, 0.1);
            }
        }
        
        /* Kablo geri dönüş animasyonu */
        @keyframes wire-return {
            0% { 
                background-color: #00ff00; 
                box-shadow: 0 0 12px #00ff00;
            }
            50% { 
                background-color: #ffffff; 
                box-shadow: 0 0 20px rgba(255, 255, 255, 0.9);
            }
            100% { 
                background-color: #ff00aa; 
                box-shadow: 0 0 10px rgba(255, 0, 170, 0.7);
            }
        }
        
        .monitor.transfer-receive {
            animation: transfer-glow 1s forwards;
        }
        
        .monitor.return-to-fuschia {
            animation: return-to-fuschia 1s forwards;
        }
        
        .wire.return-to-fuschia {
            animation: wire-return 1s forwards;
        }
        
        /* Fuşya renge dönüş animasyonu */
        @keyframes return-to-fuschia {
            0% { border-color: #00ff00; box-shadow: 0 0 15px rgba(0, 255, 0, 0.7); }
            100% { border-color: #ff00aa; box-shadow: 0 0 10px rgba(255, 0, 170, 0.6); }
        }
        
        /* Kablo dönüş animasyonu */
        @keyframes wire-return {
            0% { background-color: #00ff00; box-shadow: 0 0 8px #00ff00; }
            100% { background-color: #ff00aa; box-shadow: 0 0 8px #ff00aa; }
        }
        
        .monitor.return-to-fuschia {
            animation: return-to-fuschia 0.8s forwards;
        }
        
        .wire.return-to-fuschia {
            animation: wire-return 0.8s forwards;
        }
        
        /* Monitörün fuşyaya dönme animasyonu */
        @keyframes return-to-fuschia {
            0% { background-color: #00ff00; box-shadow: 0 0 10px #00ff00; }
            100% { background-color: #ff00ff; box-shadow: 0 0 10px #ff00ff; }
        }
        
        /* Kablonun fuşyaya dönme animasyonu */
        @keyframes wire-return {
            0% { background-color: #00ff00; box-shadow: 0 0 5px #00ff00; }
            100% { background-color: #ff00ff; box-shadow: 0 0 5px #ff00ff; }
        }
        
        .monitor.return-to-fuschia {
            animation: return-to-fuschia 1s ease-out forwards;
        }
        
        .wire.return-to-fuschia {
            animation: wire-return 0.8s ease-out forwards;
        }
        
        /* Yeni efekt CSS */
        .pulse-effect {
            animation: pulse-usb 1s infinite;
            box-shadow: 0 0 30px 10px #00ffea, 0 0 60px 20px #ff00aa44;
        }
        @keyframes pulse-usb {
            0% { box-shadow: 0 0 10px 2px #00ffea, 0 0 20px 5px #ff00aa44; }
            50% { box-shadow: 0 0 30px 10px #00ffea, 0 0 60px 20px #ff00aa44; }
            100% { box-shadow: 0 0 10px 2px #00ffea, 0 0 20px 5px #ff00aa44; }
        }
        .arrowBtn {
            /* ... mevcut kod ... */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .arrow-img {
            width: 70%;
            height: 70%;
            object-fit: contain;
            pointer-events: none;
        }
        #usb {
            /* ... mevcut kod ... */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .usb-img {
            width: 70%;
            height: 70%;
            object-fit: contain;
            pointer-events: none;
        }
        /* --- YENİ: Sadece tekli kilitlenme için özel animasyon --- */
        @keyframes single-lock {
          0% { transform: scale(1); box-shadow: 0 0 0 0 #00ff00; border-color: #00ff00; }
          50% { transform: scale(1.2); box-shadow: 0 0 15px 5px #00ff00; border-color: #00ff00; }
          100% { transform: scale(1); box-shadow: 0 0 0 0 #00ff00; border-color: #00ff00; }
        }
        .single-locked {
          animation: single-lock 0.5s ease;
          border-color: #00ff00 !important;
          box-shadow: 0 0 10px #00ff00;
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <!-- Başlangıç ekranı -->
        <div id="startScreen" class="gameScreen">
            <h1 class="screenTitle">SİBER HACK SİMÜLATÖRÜ</h1>
            <p class="screenText">Hedef sisteme erişmek için antivirüs korumasını atlatın ve şifreyi kırın. Her aşama için 60 saniyeniz var.</p>
            <button id="startButton" class="bigBtn">HACK BAŞLAT</button>
        </div>
        
        <!-- Oyun bitti ekranı -->
        <div id="gameOverScreen" class="gameScreen">
            <h1 class="screenTitle">ERİŞİM ENGELLENDİ</h1>
            <p class="screenText">Antivirüs yazılımı saldırınızı engelledi! Tekrar denemek ister misiniz?</p>
            <button id="restartButton" class="bigBtn">YENİDEN DENE</button>
        </div>
        
        <!-- Kazanma ekranı -->
        <div id="winScreen" class="gameScreen">
            <div class="win-content" style="width: 100%; max-width: 90%; text-align: center;">
                <h1 class="screenTitle">ERİŞİM SAĞLANDI!</h1>
                <p class="screenText">Kalan süre: <span id="remainingTime">00:00</span></p>
                <p class="screenText">Güvenlik yazılımı engellendi ve şifreli klasörün kilidini açmak için hazır ol!</p>
                <button id="playAgainButton" class="bigBtn">DEVAM ET</button>
            </div>
        </div>
        
        <!-- Kablo container - burada kablolar dinamik olarak oluşturulacak -->
        <div class="wires-container" id="wiresContainer"></div>
        
        <!-- CPU ve sistemi kaldırıldı -->
        
        <!-- Antivirüs kalkanı kaldırıldı -->
        
        <!-- Zaman sayacı -->
        <div id="timer">60:00</div>
        
        <!-- Üst monitör sırası (PASSWORD) -->
        <div class="monitorRow" id="passwordRow">
            <div class="monitor password-monitor" data-index="0">?</div>
            <div class="monitor password-monitor" data-index="1">?</div>
            <div class="monitor password-monitor" data-index="2">?</div>
            <div class="monitor password-monitor" data-index="3">?</div>
            <div class="monitor password-monitor" data-index="4">?</div>
            <div class="monitor password-monitor" data-index="5">?</div>
            <div class="monitor password-monitor" data-index="6">?</div>
            <div class="monitor password-monitor" data-index="7">?</div>
            <div class="monitor password-monitor" data-index="8">?</div>
            <div class="monitor password-monitor" data-index="9">?</div>
        </div>
        
        <!-- Alt monitör sırası (Kod Modülleri) -->
        <div class="monitorRow" id="codeRow">
            <div class="monitor code-monitor" data-index="0">?</div>
            <div class="monitor code-monitor" data-index="1">?</div>
            <div class="monitor code-monitor" data-index="2">?</div>
            <div class="monitor code-monitor" data-index="3">?</div>
            <div class="monitor code-monitor" data-index="4">?</div>
            <div class="monitor code-monitor" data-index="5">?</div>
            <div class="monitor code-monitor" data-index="6">?</div>
            <div class="monitor code-monitor" data-index="7">?</div>
            <div class="monitor code-monitor" data-index="8">?</div>
            <div class="monitor code-monitor" data-index="9">?</div>
        </div>
        
        <!-- USB ve kontroller -->
        <div id="usbContainer">
            <div class="usb-row">
                <div class="side-controls">
                    <button id="leftBtn" class="btn arrowBtn">←</button>
                </div>
                <div id="usb">
                    <img src="usb.png" alt="USB" class="usb-img">
                </div>
                <div class="side-controls">
                    <button id="rightBtn" class="btn arrowBtn">→</button>
                </div>
            </div>
            <div class="controls">
                <button id="connectBtn" class="btn">CONNECT</button>
            </div>
        </div>
    </div>

    <!-- Ses dosyaları için audio elementleri - gizli -->
    <div style="display: none;">
        <!-- Genel Oyun Sesleri -->
        <audio id="GAME_START" src="GAME_START.WAV" preload="auto"></audio>
        <audio id="TIME_UP_ALARM" src="TIME_UP_ALARM.WAV" preload="auto"></audio>
        <audio id="GAME_SUCCESS" src="GAME_SUCCESS.WAV" preload="auto"></audio>
        <audio id="GAME_FAILURE" src="GAME_FAILURE.WAV" preload="auto"></audio>
        
        <!-- Etkileşim Sesleri -->
        <audio id="USB_CLICK" src="USB_CLICK.WAV" preload="auto"></audio>
        <audio id="USB_STOP" src="USB_STOP.WAV" preload="auto"></audio>
        <audio id="ARROW_CLICK" src="ARROW_CLICK.WAV" preload="auto"></audio>
        <audio id="CONNECT_CLICK" src="CONNECT_CLICK.WAV" preload="auto"></audio>
        
        <!-- Bildirim Sesleri -->
        <audio id="CORRECT_MONITOR" src="CORRECT_MONITOR.WAV" preload="auto"></audio>
        <audio id="WRONG_MONITOR" src="WRONG_MONITOR.WAV" preload="auto"></audio>
        <audio id="ALREADY_LOCKED" src="ALREADY_LOCKED.WAV" preload="auto"></audio>
        
        <!-- Animasyon Sesleri -->
        <audio id="TRANSFER_WHOOSH" src="TRANSFER_WHOOSH.WAV" preload="auto"></audio>
        <audio id="SHIELD_ACTIVE" src="SHIELD_ACTIVE.WAV" preload="auto"></audio>
        <audio id="WIRE_ACTIVE" src="WIRE_ACTIVE.WAV" preload="auto"></audio>
        <audio id="SHIELD_GREEN" src="SHIELD_GREEN.WAV" preload="auto"></audio>
        
        <!-- Süre Efektleri -->
        <audio id="TIME_15_WARNING" src="TIME_15_WARNING.WAV" preload="auto"></audio>
        <audio id="TIME_5_BEEP" src="TIME_5_BEEP.WAV" preload="auto"></audio>
        
        <!-- Özel Efektler -->
        <audio id="SYSTEM_RESET" src="SYSTEM_RESET.WAV" preload="auto"></audio>
        <audio id="TIME_UP_SCREEN" src="TIME_UP_SCREEN.WAV" preload="auto"></audio>
    </div>

    <script>
        // Sayfa yenilendiğinde oyun sıfırlanır - bunu garanti etmek için window.onload kullanıyoruz
        window.onload = function() {
            // Kazanma ekranını direk gizliyoruz - kısa görünmeyi engellemek için
            document.getElementById('winScreen').style.display = 'none';
            
            resetGame();
            // Kabloları başlangıçta oluştur
            createWires();
            // Pencere boyutu değiştiğinde kabloları yeniden konumlandır
            window.addEventListener('resize', updateWirePositions);
            
            // Mobil cihaz kontrolü ve optimizasyonları
            checkIfMobile();
            
            // Olay dinleyicilerini ayarla
            setupEventListeners();
            
            // Ses dosyalarını önbelleğe al
            preloadSounds();
        };
        
        // Ses efektlerini çalmak için yardımcı fonksiyon
        function playSound(id) {
            try {
                const sound = document.getElementById(id);
                if (sound) {
                    // Eğer ses halihazırda çalıyorsa, baştan başlat
                    sound.pause();
                    sound.currentTime = 0;
                    
                    // Sesi çal
                    sound.play().catch(e => {
                        console.log(`Ses çalma hatası (${id}):`, e);
                    });
                }
            } catch (error) {
                console.log(`Ses çalma hatası (${id}):`, error);
            }
        }
        
        // Ses dosyalarını önbelleğe alma
        function preloadSounds() {
            const audioElements = document.querySelectorAll('audio');
            audioElements.forEach(audio => {
                audio.load();
            });
        }
        
        // Tüm olay dinleyicilerini ayarlama
        function setupEventListeners() {
            // Oyun başlatma/yeniden başlatma butonları
            startButton.addEventListener('click', function() {
                playSound('GAME_START');
                initGame();
            });
            
            restartButton.addEventListener('click', function() {
                playSound('GAME_START');
                initGame();
            });
            
            playAgainButton.addEventListener('click', function() {
                playSound('GAME_START');
                initGame();
            });
            
            // USB'ye tıklama için olay dinleyicisi
            usb.addEventListener('click', function() {
                if (!gameStarted || gameOver) return;
                
                if (!spinning) {
                    playSound('USB_CLICK');
                    startSpinning();
                } else {
                    playSound('USB_STOP');
                    stopSpinning();
                }
            });
            
            // Sol ok tuşu - Döngü sırasında da çalışacak şekilde düzeltildi
            leftBtn.addEventListener('click', function(e) {
                e.preventDefault();
                if (!gameStarted || gameOver) return;
                // Spinning kontrolü tamamen kaldırıldı
                
                // 1. kutudan sola gidilmesini engelle
                if (selectedMonitorIndex === 0) {
                    return; // 1. kutudaysa hareketi engelle
                }
                
                playSound('ARROW_CLICK');
                
                // Normal olarak bir sola git
                selectedMonitorIndex = selectedMonitorIndex - 1;
                updateMonitorSelection();
            });
            
            // Sağ ok tuşu - Döngü sırasında da çalışacak şekilde düzeltildi
            rightBtn.addEventListener('click', function(e) {
                e.preventDefault();
                if (!gameStarted || gameOver) return;
                // Spinning kontrolü tamamen kaldırıldı
                
                // Son kutudan sağa gidilmesini engelle
                if (selectedMonitorIndex === 9) {
                    return; // Son kutudaysa hareketi engelle
                }
                
                playSound('ARROW_CLICK');
                
                // Normal olarak bir sağa git
                selectedMonitorIndex = selectedMonitorIndex + 1;
                updateMonitorSelection();
            });
            
            // Connect butonu - Sadece döngü durduğunda çalışsın
            connectBtn.addEventListener('click', function(e) {
                e.preventDefault();
                if (!gameStarted || gameOver) return;
                
                // Döngü devam ederken connect butonunu engelle
                if (spinning) {
                    return; // Döngü devam ediyorsa işlemi engelle
                }
                
                // İşlemde olup olmadığını kontrol et
                if (isConnectProcessing) {
                    return; // Zaten bir işlem yapılıyorsa engelle
                }
                
                playSound('CONNECT_CLICK');
                
                lockSelectedMonitor();
            });
            
            // Klavye kontrolleri
            window.addEventListener('keydown', function(e) {
                if (!gameStarted || gameOver) return;
                
                switch(e.key) {
                    case 'ArrowLeft':
                        // Spinning kontrolü tamamen kaldırıldı
                        leftBtn.click(); // Sol buton kodunu kullan
                        break;
                    case 'ArrowRight':
                        // Spinning kontrolü tamamen kaldırıldı
                        rightBtn.click(); // Sağ buton kodunu kullan
                        break;
                    case 'Enter':
                    case ' ':
                        if (spinning) return; // Connect için döngü kontrolü hala aktif
                        connectBtn.click(); // Connect buton kodunu kullan
                        break;
                    case 'Escape':
                        if (!spinning) {
                            startSpinning();
                        } else {
                            stopSpinning();
                        }
                        break;
                }
            });
        }
        
        // Oyun değişkenleri
        let gameStarted = false;
        let gameOver = false;
        let currentStage = 1; // 1: Antivirüs bypass, 2: Şifre kırma
        let timer = 60; // 60 saniye süre
        let timerInterval;
        let selectedMonitorIndex = 0;
        let spinning = false;
        let spinningInterval = null;
        let codeModulesLocked = Array(10).fill(false);
        let passwordModulesLocked = Array(10).fill(false);
        let scorePoints = 0;
        let timeLimit = true; // Süre sınırını aktif et
        let isConnectProcessing = false; // Connect butonunun işlemde olup olmadığını takip eden değişken
        
        // Yeni değişkenler
        let activeShields = []; // Aktif olan shield'ların indekslerini tutar
        let correctBoxPerShield = {}; // Her shield için doğru kutu indeksi
        let currentShieldCount = 0; // Mevcut turda aktif olan shield sayısı
        
        // Doğru kod ve şifreler - Artık her turda rastgele belirlenecek
        // const correctCodes = ['Y', 'K', '3', 'C', '0', 'F', 'B', 'X', 'V', '9'];
        const correctPasswords = ['?', '?', '?', '?', '?', '?', '?', '?', '?', '?'];
        
        // Rastgele karakter oluşturma
        function getRandomChar() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            return chars[Math.floor(Math.random() * chars.length)];
        }
        
        // DOM Elementleri
        const startScreen = document.getElementById('startScreen');
        const gameOverScreen = document.getElementById('gameOverScreen');
        const winScreen = document.getElementById('winScreen');
        const startButton = document.getElementById('startButton');
        const restartButton = document.getElementById('restartButton');
        const playAgainButton = document.getElementById('playAgainButton');
        const timerElement = document.getElementById('timer');
        const codeMonitors = document.querySelectorAll('#codeRow .monitor');
        const passwordMonitors = document.querySelectorAll('#passwordRow .monitor');
        const miniShields = document.querySelectorAll('.miniShield');
        const usb = document.getElementById('usb');
        const leftBtn = document.getElementById('leftBtn');
        const rightBtn = document.getElementById('rightBtn');
        const connectBtn = document.getElementById('connectBtn');
        
        // Oyunu tamamen sıfırla
        function resetGame() {
            // Tüm değişkenleri başlangıç durumuna getir
            gameStarted = false;
            gameOver = false;
            currentStage = 1;
            timer = 60; // 60 saniye
            selectedMonitorIndex = 0;
            spinning = false;
            
            if (spinningInterval) {
                clearInterval(spinningInterval);
                spinningInterval = null;
            }
            
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            
            codeModulesLocked = Array(10).fill(false);
            passwordModulesLocked = Array(10).fill(false);
            scorePoints = 0;
            
            // Başlangıç ekranını göster, diğerlerini gizle
            startScreen.style.display = 'flex';
            gameOverScreen.style.display = 'none';
            winScreen.style.display = 'none';
            
            // Tüm modülleri sıfırla
            codeMonitors.forEach(monitor => {
                monitor.textContent = '?';
                monitor.classList.remove('selected', 'locked', 'correct', 'just-locked', 'correct-value');
            });
            
            passwordMonitors.forEach(monitor => {
                monitor.classList.remove('selected', 'locked', 'correct', 'just-locked', 'correct-value');
            });
            
            miniShields.forEach(shield => {
                shield.classList.remove('active', 'matrix-green');
            });
            
            // Tüm animasyonları sıfırla - 8 ve 9 numaralı monitörlerin takılı kalma hatasını düzeltir
            resetAllAnimations();
            
            // Zamanlayıcıyı sıfırla
            updateTimer();
            
            // Kabloları sıfırla
            resetWires();
            
            // USB efektini sıfırla
            usb.classList.remove('pulse-effect');
        }
        
        // Oyunu başlat
        function initGame() {
            // Oyunu önce sıfırla
            resetGame();
            
            // Oyun ekranlarını ayarla
            startScreen.style.display = 'none';
            
            // Oyunu başlat
            gameStarted = true;
            
            // Zamanlayıcıyı başlat (süre sınırı açık)
            if (timeLimit) {
                timer = 60; // 60 saniye
                timerInterval = setInterval(updateTimer, 1000);
            }
            
            // İlk aşama için monitörleri ayarla
            updateMonitorSelection();
            
            // Tüm animasyonları sıfırla - oyun başlarken 8 ve 9 numaralı monitörlerin takılı kalma hatasını düzeltir
            resetAllAnimations();
        }
        
        // Zamanlayıcıyı güncelle
        function updateTimer() {
            if (timeLimit && timer <= 0) {
                // Süre doldu, tüm kilitli kutuları resetle
                playSound('TIME_UP_ALARM');
                resetLockedBoxes();
                // Süreyi tekrar başlat
                timer = 60;
                return;
            }
            
            if (timeLimit) {
                timer--;
                
                // 15 saniye kaldığında ses çal
                if (timer === 15) {
                    playSound('TIME_15_WARNING');
                }
                
                // Son 5 saniye için geri sayım sesi
                if (timer <= 5 && timer > 0) {
                    playSound('TIME_5_BEEP');
                }
            }
            
            const minutes = Math.floor(timer / 60);
            const seconds = timer % 60;
            timerElement.textContent = timeLimit ? 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}` : 
                "∞"; // Sonsuz sembolü
        }
        
        // Kilitli kutuları resetle - yeni fonksiyon
        function resetLockedBoxes() {
            // Animasyon efektiyle kilitleri aç
            showTimerExpiredEffect();
            playSound('SYSTEM_RESET');
            
            // Tüm monitörleri kilitsiz duruma getir
            codeModulesLocked = Array(10).fill(false);
            passwordModulesLocked = Array(10).fill(false);
            
            // Tüm monitörleri güncelle
            codeMonitors.forEach(monitor => {
                monitor.classList.remove('locked', 'correct', 'just-locked');
                if (!spinning) {
                    monitor.textContent = '?';
                }
            });
            
            // Üst monitörleri de temizle
            passwordMonitors.forEach(monitor => {
                monitor.textContent = '?';
            });
            
            // Tüm animasyonları sıfırla
            resetAllAnimations();
            
            // Seçimi güncelle
            updateMonitorSelection();
        }
        
        // Süre dolduğunda efekt göster
        function showTimerExpiredEffect() {
            // Geçici bir overlay oluştur
            const overlay = document.createElement('div');
            overlay.className = 'transition-overlay';
            overlay.style.opacity = '0';
            overlay.innerHTML = `<div class="transition-text">SÜRE DOLDU!</div>`;
            document.body.appendChild(overlay);
            
            // Animasyon için overlay'ı göster
            setTimeout(() => {
                overlay.style.opacity = '1';
                playSound('TIME_UP_SCREEN');
                
                // 2 saniye sonra kaybol
                setTimeout(() => {
                    overlay.style.opacity = '0';
                    
                    // Tamamen kaybolunca DOM'dan kaldır
                    setTimeout(() => {
                        document.body.removeChild(overlay);
                    }, 1000);
                }, 1500);
            }, 50);
        }
        
        // Monitörleri sıfırla
        function resetModules() {
            // Kod modüllerini sıfırla
            codeMonitors.forEach(monitor => {
                monitor.textContent = '?';
                monitor.classList.remove('selected', 'locked');
            });
            
            // Şifre modüllerini sıfırla
            passwordMonitors.forEach(monitor => {
                monitor.classList.remove('selected', 'locked');
            });
            
            // Kalkanları sıfırla
            miniShields.forEach(shield => {
                shield.classList.remove('active');
            });
            
            codeMonitors[0].classList.add('selected');
        }
        
        // Monitör seçimini güncelle
        function updateMonitorSelection() {
            const currentRow = currentStage === 1 ? codeMonitors : passwordMonitors;
            const lockedArray = currentStage === 1 ? codeModulesLocked : passwordModulesLocked;
            
            // Tüm seçimleri kaldır
            currentRow.forEach(monitor => {
                monitor.classList.remove('selected');
                // Renk tutarlılığı için correct-value sınıfını korumalıyız, onu kaldırmıyoruz
            });
            
            // Tüm kabloları deaktif yap
            resetWireActiveStatus();
            
            // Yeni seçili monitörü işaretle
            currentRow[selectedMonitorIndex].classList.add('selected');
            
            // İlgili kabloyu aktif yap
            if (currentStage === 1) {
                const wire = document.getElementById(`wire-${selectedMonitorIndex}`);
                if (wire) {
                    wire.classList.add('active');
                }
            }
        }
        
        // Slot makinesi efekti başlat
        function startSpinning() {
            if (spinning) return; // Zaten dönüyor
            
            // Connect işlem flag'ini resetle çünkü döngü yeniden başlıyor
            isConnectProcessing = false;
            
            spinning = true;
            usb.classList.add('active');
            
            const row = currentStage === 1 ? codeMonitors : passwordMonitors;
            const lockedArray = currentStage === 1 ? codeModulesLocked : passwordModulesLocked;
            
            // Tüm aktif shield'ları sıfırla
            activeShields = [];
            document.querySelectorAll('.miniShield').forEach(shield => {
                shield.classList.remove('matrix-green');
            });
            
            // Füşya animasyon hatasını düzeltmek için
            resetAllAnimations();
            
            // Kilitlenememiş tüm monitörlerde karakter değişimi başlat
            spinningInterval = setInterval(() => {
                // Kilitlenmemiş modülleri güncelle
                row.forEach((monitor, index) => {
                    if (!lockedArray[index]) {
                        // Değişim hızını yarıya indirmek için ek rastgele kontrol
                        if (Math.random() > 0.5) {
                            monitor.textContent = getRandomChar();
                        }
                    }
                });
            }, 100); // 100ms aralıklarla güncelleme
        }
        
        // Döndürmeyi durdur ve ipuçlarını göster
        function stopSpinning() {
            if (!spinning) return; // Zaten durmuş
            
            spinning = false;
            usb.classList.remove('active');
            
            if (spinningInterval) {
                clearInterval(spinningInterval);
                spinningInterval = null;
            }
            
            const row = currentStage === 1 ? codeMonitors : passwordMonitors;
            
            // Alt monitörlerdeki kilitlenememiş tüm kutuları rastgele karakterlerle doldur
            row.forEach((monitor, index) => {
                if (!monitor.classList.contains('locked')) {
                    // Tüm monitörlere rastgele değerler ata
                    monitor.textContent = getRandomChar();
                    monitor.classList.remove('correct-value');
                }
            });
            
            // Rastgele tek bir shield seçilmesini sağla
            selectRandomShields();
        }
        
        // Rastgele shield'ları seçip aktifleştir
        function selectRandomShields() {
            // Tüm kalkanları sıfırla
            document.querySelectorAll('.miniShield').forEach(shield => {
                shield.classList.remove('matrix-green');
            });
            
            // Aktif shield listesini temizle
            activeShields = [];
            correctBoxPerShield = {};
            
            // Kullanılabilir shield'ları bul - en az bir monitörü kilitlenmemiş olan shield'lar
            const availablePairs = [];
            
            for (let i = 0; i < 9; i++) {
                // İki monitor arasındaki shield
                const firstBoxIndex = i;
                const secondBoxIndex = i + 1;
                
                // İki monitörden EN AZ BİRİNİN kilitlenmemiş olmasını kontrol et
                if (!codeModulesLocked[firstBoxIndex] || !codeModulesLocked[secondBoxIndex]) {
                    availablePairs.push(i); // Shield indeksi ekleniyor
                }
            }
            
            // Eğer kullanılabilir çift yoksa işlem yapma
            if (availablePairs.length === 0) {
                currentShieldCount = 0;
                console.log("Kullanılabilir shield kalmadı");
                return;
            }
            
            // Her zaman sadece 1 shield seç
            currentShieldCount = 1;
            
            // Kullanılabilir çiftlerden rastgele seçim yap
            const randomIndex = Math.floor(Math.random() * availablePairs.length);
            const selectedShieldIndex = availablePairs[randomIndex];
            
            // Seçilen shield'ı aktif shield listesine ekle
            activeShields.push(selectedShieldIndex);
            
            // Bu shield'a ait kutulardan kilitlenmemiş olanları bul
            const firstBoxIndex = selectedShieldIndex;
            const secondBoxIndex = selectedShieldIndex + 1;
            
            const unlocked = [];
            if (!codeModulesLocked[firstBoxIndex]) unlocked.push(firstBoxIndex);
            if (!codeModulesLocked[secondBoxIndex]) unlocked.push(secondBoxIndex);
            
            // Kilitlenmemiş kutuları kullanarak doğru kutuyu belirle
            let correctBoxIndex;
            
            // Eğer iki kutuda kilitlenmemiş ise rastgele birini seç
            if (unlocked.length === 2) {
                const randomBoxIndex = Math.floor(Math.random() * 2);
                correctBoxIndex = unlocked[randomBoxIndex];
            } 
            // Eğer sadece bir kutu kilitlenmemiş ise o kutu doğru olmalı
            else if (unlocked.length === 1) {
                correctBoxIndex = unlocked[0];
            }
            // Bu duruma asla gelmememiz gerekiyor ama güvenlik için ekledim
            else {
                console.error("Bu shield için kilitlenmemiş kutu kalmadı:", selectedShieldIndex);
                return; // İşlemi sonlandır
            }
            
            // Bu shield için doğru kutu indeksini kaydet
            correctBoxPerShield[selectedShieldIndex] = correctBoxIndex;
            
            // Shield'ı aktifleştir
            const shield = document.getElementById(`shield-${selectedShieldIndex}`);
            if (shield) {
                shield.classList.add('matrix-green');
                playSound('SHIELD_ACTIVE');
            }
            
            console.log("Aktif shield:", selectedShieldIndex);
            console.log("Doğru kutu:", correctBoxPerShield[selectedShieldIndex]);
        }
        
        // Seçili monitörü kilitle
        function lockSelectedMonitor() {
            if (!gameStarted || gameOver || spinning || isConnectProcessing) return;
            isConnectProcessing = true;
            disableControls();
            const row = currentStage === 1 ? codeMonitors : passwordMonitors;
            const lockedArray = currentStage === 1 ? codeModulesLocked : passwordModulesLocked;
            if (lockedArray[selectedMonitorIndex]) {
                playSound('ALREADY_LOCKED');
                startSpinning();
                setTimeout(() => {
                    isConnectProcessing = false;
                    enableControls();
                }, 200);
                return;
            }
            let isCorrectSelection = false;
            let relatedShieldIndex = -1;
            for (const shieldIndex of activeShields) {
                const firstBoxIndex = shieldIndex;
                const secondBoxIndex = shieldIndex + 1;
                if (selectedMonitorIndex === firstBoxIndex || selectedMonitorIndex === secondBoxIndex) {
                    relatedShieldIndex = shieldIndex;
                    const correctBoxForThisShield = correctBoxPerShield[shieldIndex];
                    isCorrectSelection = (selectedMonitorIndex === correctBoxForThisShield);
                    break;
                }
            }
            if (relatedShieldIndex === -1) {
                isConnectProcessing = false;
                enableControls();
                return;
            }
            if (isCorrectSelection) {
                row[selectedMonitorIndex].classList.add('locked');
                lockedArray[selectedMonitorIndex] = true;
                const wire = document.getElementById(`wire-${selectedMonitorIndex}`);
                if (wire) {
                    wire.classList.add('success');
                    playSound('WIRE_ACTIVE');
                }
                // --- SADECE TEKLİ KİLİTLENME ANİMASYONU ---
                row[selectedMonitorIndex].classList.add('single-locked');
                setTimeout(() => {
                    row[selectedMonitorIndex].classList.remove('single-locked');
                }, 500);
                playSound('CORRECT_MONITOR');
                setTimeout(() => {
                    const shield = document.getElementById(`shield-${relatedShieldIndex}`);
                    if (shield) {
                        shield.classList.remove('matrix-green');
                        playSound('SHIELD_GREEN');
                    }
                    activeShields = activeShields.filter(index => index !== relatedShieldIndex);
                }, 200);
                setTimeout(() => {
                    isConnectProcessing = false;
                    enableControls();
                    if (lockedArray.every(locked => locked)) {
                        usb.classList.add('pulse-effect');
                        playSound('GAME_START');
                        endGame(true);
                    } else {
                        startSpinning();
                    }
                }, 200);
                setTimeout(() => {
                    const selectedValue = row[selectedMonitorIndex].textContent;
                    passwordMonitors[selectedMonitorIndex].textContent = selectedValue;
                    passwordMonitors[selectedMonitorIndex].classList.add('transfer-receive');
                    playSound('TRANSFER_WHOOSH');
                    setTimeout(() => {
                        passwordMonitors[selectedMonitorIndex].classList.remove('transfer-receive');
                        if (wire) {
                            wire.classList.remove('success');
                            wire.classList.add('return-to-fuschia');
                        }
                        setTimeout(() => {
                            if (wire) {
                                wire.classList.remove('return-to-fuschia');
                            }
                        }, 1000);
                    }, 1000);
                }, 300);
            } else {
                playSound('WRONG_MONITOR');
                startSpinning();
                setTimeout(() => {
                    isConnectProcessing = false;
                    enableControls();
                }, 200);
            }
        }
        
        // --- YENİ: Kontrolleri devre dışı bırak/aktif et fonksiyonları ---
        function disableControls() {
            usb.style.pointerEvents = 'none';
            leftBtn.disabled = true;
            rightBtn.disabled = true;
            connectBtn.disabled = true;
        }
        function enableControls() {
            usb.style.pointerEvents = '';
            leftBtn.disabled = false;
            rightBtn.disabled = false;
            connectBtn.disabled = false;
        }
        
        // Oyunu bitir
        function endGame(win) {
            gameStarted = false;
            gameOver = true;
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            // Skor hesaplaması - artık ekranda gösterilmeyecek
            const correctlyLocked = calculateCorrectlyLocked();
            const timeBonus = timeLimit ? timer * 2 : 0;
            const totalScore = scorePoints + timeBonus + (correctlyLocked * 5);
            
            if (win) {
                // --- YENİ: Toplu transfer animasyonu ve mesajı ---
                playEndGameTransferAnimation().then(() => {
                    // Aşama tamamlandı ekranında kalan süreyi göster
                    const minutes = Math.floor(timer / 60);
                    const seconds = timer % 60;
                    document.getElementById('remainingTime').textContent = 
                        `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    playSound('GAME_SUCCESS');
                    winScreen.style.display = 'flex';
                });
            } else {
                playSound('GAME_FAILURE');
                gameOverScreen.style.display = 'flex';
            }
        }
        
        // --- YENİ: Toplu transfer animasyonu fonksiyonu ---
        async function playEndGameTransferAnimation() {
            // 1. Alt kutulardan üst kutulara transfer (toplu)
            for (let i = 0; i < 10; i++) {
                // Kabloları yeşil yap ve animasyon başlat
                const wire = document.getElementById(`wire-${i}`);
                if (wire) {
                    wire.classList.add('success');
                }
                // Alt kutuyu yeşil yap
                codeMonitors[i].classList.add('locked', 'correct');
                // Üst kutuya aktar
                const value = codeMonitors[i].textContent;
                passwordMonitors[i].textContent = value;
                // Üst kutuda transfer animasyonu
                passwordMonitors[i].classList.add('transfer-receive');
            }
            // Ses efektleri topluca çal
            playSound('WIRE_ACTIVE');
            playSound('CORRECT_MONITOR');
            playSound('TRANSFER_WHOOSH');
            // Biraz bekle (animasyon süresi)
            await new Promise(res => setTimeout(res, 2500));

            // 2. Alt kutular ve kablolar fuşyaya döner (toplu)
            for (let i = 0; i < 10; i++) {
                passwordMonitors[i].classList.remove('transfer-receive');
                codeMonitors[i].classList.remove('locked', 'correct');
                codeMonitors[i].classList.add('return-to-fuschia');
                const wire = document.getElementById(`wire-${i}`);
                if (wire) {
                    wire.classList.remove('success');
                    wire.classList.add('return-to-fuschia');
                }
            }
            playSound('TRANSFER_WHOOSH');
            await new Promise(res => setTimeout(res, 2000));

            // Animasyonları temizle
            for (let i = 0; i < 10; i++) {
                codeMonitors[i].classList.remove('return-to-fuschia');
                const wire = document.getElementById(`wire-${i}`);
                if (wire) {
                    wire.classList.remove('return-to-fuschia');
                }
            }

            // 3. Üstten alta transfer animasyonu (sırayla)
            for (let i = 0; i < 10; i++) {
                // Üst kutudan alt kutuya transfer animasyonu
                passwordMonitors[i].classList.add('transfer-receive');
                codeMonitors[i].classList.add('transfer-receive');
                const wire = document.getElementById(`wire-${i}`);
                if (wire) {
                    wire.classList.add('active');
                }
                playSound('TRANSFER_WHOOSH');
                await new Promise(res => setTimeout(res, 180)); // Her kutu için kısa bir gecikme
                // Animasyonu temizle
                passwordMonitors[i].classList.remove('transfer-receive');
                codeMonitors[i].classList.remove('transfer-receive');
                if (wire) {
                    wire.classList.remove('active');
                }
            }

            // 4. Modül mesajı göster
            await showModuleMessage('Tüm modüller başarıyla transfer edildi!');
        }

        // --- YENİ: Modül mesajı gösterme fonksiyonu ---
        function showModuleMessage(msg) {
            return new Promise(res => {
                // Overlay oluştur
                const overlay = document.createElement('div');
                overlay.className = 'transition-overlay';
                overlay.style.opacity = '0';
                overlay.innerHTML = `<div class="transition-text">${msg}</div>`;
                document.body.appendChild(overlay);
                setTimeout(() => {
                    overlay.style.opacity = '1';
                    setTimeout(() => {
                        overlay.style.opacity = '0';
                        setTimeout(() => {
                            document.body.removeChild(overlay);
                            res();
                        }, 800);
                    }, 1500);
                }, 50);
            });
        }
        
        // Doğru kilitlenmiş kombinasyonları hesapla
        function calculateCorrectlyLocked() {
            let correct = 0;
            
            // 1. aşamada kilitlenmiş monitör sayısı
            for (let i = 0; i < 10; i++) {
                if (codeModulesLocked[i]) {
                    correct++;
                }
            }
            
            // 2. aşamada doğru kilitlenmiş sayısı (henüz kullanılmıyor)
            if (currentStage === 2) {
                for (let i = 0; i < 10; i++) {
                    if (passwordModulesLocked[i]) {
                        correct++;
                    }
                }
            }
            
            return correct;
        }
        
        // ===== Kablo Fonksiyonları =====
        
        // Kabloları oluştur
        function createWires() {
            const wiresContainer = document.getElementById('wiresContainer');
            wiresContainer.innerHTML = '';
            
            const passwordRow = document.getElementById('passwordRow');
            const codeRow = document.getElementById('codeRow');
            
            const passwordMonitors = passwordRow.querySelectorAll('.monitor');
            const codeMonitors = codeRow.querySelectorAll('.monitor');
            
            // Her bir PASSWORD monitöründen kod monitörüne kablo çiz
            for (let i = 0; i < passwordMonitors.length; i++) {
                // Kablo oluştur
                const wire = document.createElement('div');
                wire.className = 'wire';
                wire.id = `wire-${i}`;
                wiresContainer.appendChild(wire);
                
                // Kablo konumunu ayarla
                updateWirePosition(wire, passwordMonitors[i], codeMonitors[i]);
            }
            
            // Mobil cihaz kontrolü
            const isMobile = window.innerWidth <= 767;
            // Mobil cihazlar için offset değeri
            const offsetY = isMobile ? 10 : 0;
            
            // Antivirüs ikonlarını kabloların arasına yerleştir - sadece görsel amaçlı
            for (let i = 1; i < passwordMonitors.length; i++) {
                // Sağ kablo pozisyonunu al
                const rightWire = document.getElementById(`wire-${i}`);
                const leftWire = document.getElementById(`wire-${i-1}`);
                
                if (rightWire && leftWire) {
                    // Kabloların pozisyonlarını al
                    const rightRect = rightWire.getBoundingClientRect();
                    const leftRect = leftWire.getBoundingClientRect();
                    const containerRect = document.getElementById('gameContainer').getBoundingClientRect();
                    
                    // Kabloların üst pozisyonlarının ortalaması
                    const midX = (rightRect.left + leftRect.left) / 2 + (rightRect.width + leftRect.width) / 4 - containerRect.left;
                    
                    // Üst monitör ile alt monitör arasındaki mesafenin ortası
                    const upperRect = passwordMonitors[i].getBoundingClientRect();
                    const lowerRect = codeMonitors[i].getBoundingClientRect();
                    
                    // Mobil cihazlarda kalkanlar için biraz daha fazla boşluk bırak
                    const midY = (upperRect.bottom + lowerRect.top) / 2 - containerRect.top + offsetY;
                    
                    // Antivirüs ikonunu oluştur
                    const miniShield = document.createElement('div');
                    miniShield.className = 'miniShield';
                    miniShield.id = `shield-${i-1}`;
                    miniShield.style.left = `${midX}px`;
                    miniShield.style.top = `${midY}px`;
                    wiresContainer.appendChild(miniShield);
                }
            }
        }
        
        // Kablo pozisyonlarını güncelle
        function updateWirePositions() {
            const passwordRow = document.getElementById('passwordRow');
            const codeRow = document.getElementById('codeRow');
            
            const passwordMonitors = passwordRow.querySelectorAll('.monitor');
            const codeMonitors = codeRow.querySelectorAll('.monitor');
            
            for (let i = 0; i < passwordMonitors.length; i++) {
                const wire = document.getElementById(`wire-${i}`);
                if (wire) {
                    updateWirePosition(wire, passwordMonitors[i], codeMonitors[i]);
                }
            }
            
            // Antivirüs ikonlarını yeniden konumlandır
            for (let i = 1; i < passwordMonitors.length; i++) {
                const shield = document.getElementById(`shield-${i-1}`);
                const rightWire = document.getElementById(`wire-${i}`);
                const leftWire = document.getElementById(`wire-${i-1}`);
                
                if (shield && rightWire && leftWire) {
                    // Kabloların pozisyonlarını al
                    const rightRect = rightWire.getBoundingClientRect();
                    const leftRect = leftWire.getBoundingClientRect();
                    const containerRect = document.getElementById('gameContainer').getBoundingClientRect();
                    
                    // Kabloların üst pozisyonlarının ortalaması
                    const midX = (rightRect.left + leftRect.left) / 2 + (rightRect.width + leftRect.width) / 4 - containerRect.left;
                    
                    // Üst monitör ile alt monitör arasındaki mesafenin ortası
                    const upperRect = passwordMonitors[i].getBoundingClientRect();
                    const lowerRect = codeMonitors[i].getBoundingClientRect();
                    const midY = (upperRect.bottom + lowerRect.top) / 2 - containerRect.top;
                    
                    // Kalkan pozisyonunu güncelle
                    shield.style.left = `${midX}px`;
                    shield.style.top = `${midY}px`;
                }
            }
        }
        
        // Tek bir kablonun pozisyonunu güncelle
        function updateWirePosition(wireElement, topMonitor, bottomMonitor) {
            // Üst ve alt monitörlerin pozisyon bilgilerini al
            const topRect = topMonitor.getBoundingClientRect();
            const bottomRect = bottomMonitor.getBoundingClientRect();
            const containerRect = document.getElementById('gameContainer').getBoundingClientRect();
            
            // Kablonun başlangıç ve bitiş noktaları
            const startX = topRect.left + topRect.width / 2 - containerRect.left;
            const startY = topRect.bottom - containerRect.top + 5; // 5 piksel aşağıdan başlat
            const endX = bottomRect.left + bottomRect.width / 2 - containerRect.left;
            const endY = bottomRect.top - containerRect.top - 5; // 5 piksel yukarıda bitir
            
            // Yatay fark
            const dx = endX - startX;
            // Dikey mesafe - mobil cihazlarda daha fazla mesafe olabilir
            const length = endY - startY;
            
            // Mobil cihazda ise ve dikey mesafe çok kısaysa minimum bir değer ayarla
            const isMobile = window.innerWidth <= 767;
            const minLength = isMobile ? 40 : 20; // Mobil için minimum 40px, değilse 20px
            const actualLength = Math.max(length, minLength);
            
            // Kablo stillerini ayarla
            wireElement.style.left = `${startX}px`;
            wireElement.style.top = `${startY}px`;
            
            if (Math.abs(dx) < 2) {
                // Tam dikey kablo (üst üste monitörler)
                wireElement.style.height = `${actualLength}px`;
                wireElement.style.width = `4px`;
                wireElement.style.transform = 'none';
            } else {
                // Eğimli kablo için gerçek uzunluk
                const adjustedLength = Math.sqrt(dx * dx + actualLength * actualLength);
                // Açı hesaplaması: 0 derece = düz yukarı, pozitif = sağa eğimli, negatif = sola eğimli
                const angle = Math.atan2(dx, actualLength) * (180 / Math.PI);
                
                wireElement.style.height = `${adjustedLength}px`;
                wireElement.style.width = `4px`;
                wireElement.style.transformOrigin = 'top center';
                wireElement.style.transform = `rotate(${angle}deg)`;
            }
        }
        
        // Tüm kabloları sıfırla
        function resetWires() {
            const wires = document.querySelectorAll('.wire');
            wires.forEach(wire => {
                wire.classList.remove('active');
                // success sınıfı kaldırıldı, tüm kablolar fuşya renginde kalacak
            });
            
            // Mini kalkanları sıfırlamaya gerek yok, artık sadece görsel öğeler
        }
        
        // Tüm kabloların active durumunu sıfırla
        function resetWireActiveStatus() {
            const wires = document.querySelectorAll('.wire');
            wires.forEach(wire => {
                wire.classList.remove('active');
                // success sınıfı kontrol etme işlemi kaldırıldı
            });
        }
        
        // Füşya animasyon hatasını düzeltmek için
        function resetAllAnimations() {
            // Tüm monitörlerin animasyon sınıflarını temizle
            const allMonitors = document.querySelectorAll('.monitor');
            allMonitors.forEach(monitor => {
                monitor.classList.remove('return-to-fuschia', 'transfer-receive');
            });
            
            // Tüm kabloların animasyon sınıflarını temizle
            const allWires = document.querySelectorAll('.wire');
            allWires.forEach(wire => {
                wire.classList.remove('return-to-fuschia', 'success');
            });
        }
        
        // Mobil cihaz kontrolü
        function checkIfMobile() {
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || window.innerWidth < 768;
            
            if (isMobile) {
                // Mobil için touch olayları ekleyelim
                addTouchEvents();
                
                // Kabloları mobil için optimize et
                optimizeForMobile();
                
                // Orientasyon değişikliğini izle
                window.addEventListener('orientationchange', handleOrientationChange);
                // Ekran boyutu değişikliğini de takip et (bazı cihazlarda orientationchange yerine resize çalışır)
                window.addEventListener('resize', function() {
                    // Son resize eventinden 500ms sonra handleOrientationChange çağır
                    clearTimeout(window.resizeTimer);
                    window.resizeTimer = setTimeout(handleOrientationChange, 500);
                });
                
                // Sayfa yüklendiğinde orientasyon ayarlaması yap
                handleOrientationChange();
            }
        }
        
        // Orientasyon değişikliğini yönet
        function handleOrientationChange() {
            // Orientasyon değişikliğinden sonra kısa bir gecikme ile yeniden düzenle
            setTimeout(() => {
                // Tüm kabloları ve pozisyonları sıfırla
                resetWires();
                // Kabloları yeniden oluştur
                createWires();
                updateWirePositions();
                
                const isLandscape = window.innerWidth > window.innerHeight;
                const isSmallScreen = window.innerWidth < 480;
                
                // Yeniden seçimi güncelle - kabloların yeniden oluşturulması sonrası gerekli
                updateMonitorSelection();
                
                // Tüm animasyonları sıfırla - geçiş sırasında oluşabilecek görsel hataları önler
                resetAllAnimations();
                
                // Ekran yerleşimini yatay/dikey moda göre ayarla
                if (isLandscape) {
                    // Yatay mod - daha kompakt görünüm
                    document.querySelectorAll('.monitorRow').forEach(row => {
                        row.style.margin = '10px 0';
                        row.style.maxWidth = '90%';
                    });
                    
                    document.getElementById('timer').style.margin = '10px 0 5px 0';
                    
                    // Yatay modda USB container'ı sayfanın altına yerleştirelim
                    const usbContainer = document.getElementById('usbContainer');
                    usbContainer.style.position = 'fixed';
                    usbContainer.style.bottom = '0';
                    usbContainer.style.left = '0';
                    usbContainer.style.right = '0';
                    usbContainer.style.zIndex = '50';
                    usbContainer.style.backgroundColor = 'rgba(3, 19, 33, 0.95)';
                    usbContainer.style.padding = '5px 0';
                    
                    // Yatay modda butonları yeniden boyutlandır
                    document.querySelectorAll('.arrowBtn').forEach(btn => {
                        btn.style.width = '50px';
                        btn.style.height = '50px';
                        btn.style.fontSize = '18px';
                    });
                    
                    document.getElementById('connectBtn').style.minWidth = '150px';
                    document.getElementById('connectBtn').style.height = '50px';
                    document.getElementById('connectBtn').style.fontSize = '16px';
                    
                    // Yatay modda USB'yi küçült
                    document.getElementById('usb').style.width = '50px';
                    document.getElementById('usb').style.height = '70px';
                    document.getElementById('usbIcon').style.fontSize = '30px';
                    
                    // Monitör satırları arasındaki mesafeyi azalt
                    document.getElementById('passwordRow').style.marginBottom = '20px';
                    document.getElementById('codeRow').style.marginTop = '20px';
                    
                } else {
                    // Dikey mod - normal görünüm
                    document.querySelectorAll('.monitorRow').forEach(row => {
                        row.style.maxWidth = '90%';
                        row.style.margin = isSmallScreen ? '10px 0' : '15px 0';
                    });
                    
                    document.getElementById('timer').style.margin = isSmallScreen ? '15px 0' : '20px 0';
                    
                    // USB container stil sıfırlama
                    const usbContainer = document.getElementById('usbContainer');
                    usbContainer.style.position = 'fixed';
                    usbContainer.style.bottom = isSmallScreen ? '60px' : '80px';
                    usbContainer.style.backgroundColor = 'rgba(3, 19, 33, 0.95)';
                    usbContainer.style.padding = '15px 0';
                    
                    // Dikey modda butonları orijinal boyutlarına getir
                    document.querySelectorAll('.arrowBtn').forEach(btn => {
                        btn.style.width = isSmallScreen ? '110px' : '130px';
                        btn.style.height = isSmallScreen ? '110px' : '130px';
                        btn.style.fontSize = isSmallScreen ? '52px' : '60px';
                    });
                    
                    document.getElementById('connectBtn').style.minWidth = isSmallScreen ? '300px' : '360px';
                    document.getElementById('connectBtn').style.height = isSmallScreen ? '70px' : '80px';
                    document.getElementById('connectBtn').style.fontSize = isSmallScreen ? '36px' : '40px';
                    
                    // Dikey modda USB'yi orijinal boyutuna getir
                    document.getElementById('usb').style.width = isSmallScreen ? '120px' : '160px';
                    document.getElementById('usb').style.height = isSmallScreen ? '150px' : '200px';
                    document.getElementById('usbIcon').style.fontSize = isSmallScreen ? '60px' : '80px';
                    
                    // Monitör satırları arasındaki mesafeyi ayarla
                    document.getElementById('passwordRow').style.marginBottom = isSmallScreen ? '50px' : '60px';
                    document.getElementById('codeRow').style.marginTop = isSmallScreen ? '50px' : '60px';
                }
                
                // Stil değişikliklerini anında uygula
                forceReflow();
                
            }, 300); // Küçük bir gecikme ile yeniden düzenle
        }
        
        // Stil değişikliklerinin anında uygulanmasını sağla
        function forceReflow() {
            document.body.offsetHeight; // Bu satır yeniden akışı zorlar
        }
        
        // Touch olayları ekle
        function addTouchEvents() {
            // USB butonuna dokunma olayı
            usb.addEventListener('touchstart', function(e) {
                e.preventDefault(); // Varsayılan dokunma davranışını engelle
                if (!gameStarted || gameOver) return;
                
                if (!spinning) {
                    startSpinning();
                } else {
                    stopSpinning();
                }
            });
            
            // Sol, sağ ve bağlan butonları için touch olayları - Döngü kontrolü kaldırıldı
            leftBtn.addEventListener('touchstart', function(e) {
                e.preventDefault();
                if (!gameStarted || gameOver) return;
                // Spinning kontrolü tamamen kaldırıldı
                
                // 1. kutudan sola gidilmesini engelle
                if (selectedMonitorIndex === 0) {
                    return; // 1. kutudaysa hareketi engelle
                }
                
                // Normal olarak bir sola git
                selectedMonitorIndex = selectedMonitorIndex - 1;
                updateMonitorSelection();
            });
            
            rightBtn.addEventListener('touchstart', function(e) {
                e.preventDefault();
                if (!gameStarted || gameOver) return;
                // Spinning kontrolü tamamen kaldırıldı
                
                // Son kutudan sağa gidilmesini engelle
                if (selectedMonitorIndex === 9) {
                    return; // Son kutudaysa hareketi engelle
                }
                
                // Normal olarak bir sağa git
                selectedMonitorIndex = selectedMonitorIndex + 1;
                updateMonitorSelection();
            });
            
            connectBtn.addEventListener('touchstart', function(e) {
                e.preventDefault();
                if (!gameStarted || gameOver) return;
                
                // Döngü devam ederken connect butonunu engelle
                if (spinning) {
                    return; // Döngü devam ediyorsa işlemi engelle
                }
                
                // İşlemde olup olmadığını kontrol et
                if (isConnectProcessing) {
                    return; // Zaten bir işlem yapılıyorsa engelle
                }
                
                lockSelectedMonitor();
            });
        }
        
        // Mobil cihazlar için optimize et
        function optimizeForMobile() {
            // Performans iyileştirmeleri
            const wires = document.querySelectorAll('.wire');
            wires.forEach(wire => {
                wire.style.boxShadow = '0 0 3px #ff00aa'; // Gölgeleri azalt (performans için)
            });
            
            // Oyun ekranları için metin boyutlarını uyarla
            const gameScreens = document.querySelectorAll('.gameScreen');
            gameScreens.forEach(screen => {
                const title = screen.querySelector('.screenTitle');
                const text = screen.querySelector('.screenText');
                
                if (title && window.innerWidth < 480) {
                    title.style.fontSize = '24px';
                }
                
                if (text && window.innerWidth < 480) {
                    text.style.fontSize = '14px';
                    text.style.maxWidth = '90%';
                }
            });
        }
    </script>
</body>
</html> 
